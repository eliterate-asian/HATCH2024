from Bio.Blast import NCBIWWW
from Bio.Blast import NCBIXML
import time

print("EXECUTION START")
starttime = time.time()

minutemark = str((time.time() - starttime)/60)
print("READING FASTA DATA, ", minutemark, " SINCE EXECUTION.")
sequence_data = open("./Tools/Astro1_MTHFR.fasta").read() 

minutemark = str((time.time() - starttime)/60)
print("BLASTING FASTA DATA, ", minutemark, " SINCE EXECUTION.")
result_handle = NCBIWWW.qblast("blastn", "nt", "ACTGCGTTCCCCGCCCCTGCAGCGGCCACAGTGGTGCGGCCGGCGGCCGAGCGTTCTGAGTCACCCGGGACTGGAGGGAACCCAGCCATGGTGAACGAAGCCAGAGGAAACAGCAGCCTCAACCCCTGCTTGGAGGGCAGTGCCAGCAGTGGCAGTGAGAGCTCCAAAGATAGTTCGAGATGTTCCACCCCGGGCCTGGACCCCGAGCGGCATGAGAGACTCCGGGAGAAGATGAGGCGGCGATTGGAATCTGGTGACAAGTGGTTCTCCCTGGAATTCTTCCCTCCTCGAACTGCTGAGGGAGCTGTCAATCTCATCTCAAGGTTTGACCGGATGGCAGCAGGTGGCCCCCTCTACATAGACGTGACCTGGCACCCAGCAGGTGACCCTGGCTCAGACAAGGAGACCTCCTCCATGATGATCGCCAGCACCGCCGTGAACTACTGTGGCCTGGAGACCATCCTGCACATGACCTGCTGCCGTCAGCGCCTGGAGGAGATCACGGGCCATCTGCACAAAGCTAAGCAGCTGGGCCTGAAGAACATCATGGCGCTGCGGGGAGACCCAATAGGTGACCAGTGGGAAGAGGAGGAGGGAGGCTTCAACTACGCAGTGGACCTGGTGAAGCACATCCGAAGTGAGTTTGGTGACTACTTTGACATCTGTGTGGCAGGTTACCCCAAAGGCCACCCCGAAGCAGGGAGCTTTGAGGCTGACCTGAAGCACTTGAAGGAGAAGGTGTCTGCGGGAGCCGATTTCATCATCACGCAGCTTTTCTTTGAGGCTGACACATTCTTCCGCTTTGTGAAGGCATGCACCGACATGGGCATCACTTGCCCCATCGTCCCCGGGATCTTTCCCATCCAGGGCTACCACTCCCTTCGGCAGCTTGTGAAGCTGTCCAAGCTGGAGGTGCCACAGGAGATCAAGGACGTGATTGAGCCAATCAAAGACAACGATGCTGCCATCCGCAACTATGGCATCGAGCTGGCCGTGAGCCTGTGCCAGGAGCTTCTGGCCAGTGGCTTGGTGCCAGGCCTCCACTTCTACACCCTCAACCGCGAGATGGCTACCACAGAGGTGCTGAAGCGCCTGGGGATGTGGACTGAGGACCCCAGGCGTCCCCTACCCTGGGCTCTCAGCGCCCACCCCAAGCGCCGAGAGGAAGATGTACGTCCCATCTTCTGGGCCTCCAGACCAAAGAGTTACATCTACCGTACCCAGGAGTGGGACGAGTTCCCTAACGGCCGCTGGGGCAATTCCTCTTCCCCTGCCTTTGGGGAGCTGAAGGACTACTACCTCTTCTACCTGAAGAGCAAGTCCCCCAAGGAGGAGCTGCTGAAGATGTGGGGGGAGGAGCTGACCAGTGAAGAAAGTGTCTTTGAAGTCTTCGTTCTTTACCTCTCGGGAGAACCAAACCGGAATGGTCACAAAGTGACTTGCCTGCCCTGGAACGATGAGCCCCTGGCGGCTGAGACCAGCCTGCTGAAGGAGGAGCTGCTGCGGGTGAACCGCCAGGGCATCCTCACCATCAACTCACAGCCCAACATCAACGGGAAGCCGTCCTCCGACCCCATCGTGGGCTGGGGCCCCAGCGGGGGCTATGTCTTCCAGAAGGCCTACTTAGAGTTTTTCACTTCCCGCGAGACAGCGGAAGCACTTCTGCAAGTGCTGAAGAAGTACGAGCTCCGGGTTAATTACCACCTTGTCAATGTGAAGGGTGAAAACATCACCAATGCCCCTGAACTGCAGCCGAATGCTGTCACTTGGGGCATCTTCCCTGGGCGAGAGATCATCCAGCCCACCGTAGTGGATCCCGTCAGCTTCATGTTCTGGAAGGTGGTGGAAGACACATTGGAGCTTCTCAACAGGCCCACCCAGAATGCGAGAGAAACGGAGGCTCCATGACCCTGCGTCCTGACGCCCTGCGTTGGAGCCACTCCTGTCCCGCCTTCCTCCTCCACAGTGCTGCTTCTCTTGGGAACTCCACTCTCCTTCGTGTCTCTCCCACCCCGGCCTCCACTCCCCCACCTGACAATGGCAGCTAGACTGGAGTGAGGCTTCCAGGCTCTTCCTGGACCTGAGTCGGCCCCACATGGGAACCTAGTACTCTCTGCTCTAGCCAGGAGTCTGTGCTCTTTTGGTGGGGAGCACTTGCGTCCTGCAGAGGACCACAGTGGGTGGCACCTCCTGAGAAGGCGAGGAGAGTGGTTGTTGCCAACTAAGCCCTCGAACCAAGGCAGCCTCCAGAGCCAGCCTGGGACTCCCAGTGAACTTACACTTGGAGCCCGTGCAGTACAGGCAAAACACGCAAGGGCATCAGGCACTGGTGGCATCGTAGAAGAGATGTGGCAAAGTGCTGTACCCTTCCACCTCCTAGAGGTGGGCAGCTGGGCCCCACCTACTTGTGACTGAAGGGGCACACCACTGCCCTGCCTGCCCACTTAGCCGTCCATGGCACCAGCCCCCTGGATGGGCATTGGGCTGACACCTACCATGCTGCTTTTTGGCACAGTTGTCTATTCTGAGCCTTGAGAGAAAAAGTGCCCCTTAAGGGTTGAAGGCAGTCTGAACCCTTGTGCTTGGTGGGGCTCGTGGCCTTCCCCTTTTGCCTGGCTGTGGAGGCCTGATGCTGCCCCGTTCCCTGTCAGAGGCTAAGATGAGATTTGCCAGCACAGGGGCCCCAGATCTGCCTGGGCCTGTGCAGCAGCCCAGCTTCCTGGTGTATTTTTCAGGTAGGCCCTTGTCCTGCCAGCTGCCTTCCTCATCCCCTCGTCCTGTCCCAGAGGTTATCTGCCTGGCCTGGCTCCCCACGAGTCACCTGCAAGCCCCAGGGCCTGGGGGCAGTGACTGGCAGGTGCAGATGGGCTGTTTCGTGTAGTGGAAGAGCAGCCTGATGGCCAAGGGGGTGGACGCAATTGTGGGATGTCCTCTTTACTCCCTTCCTGGCCTCACTGGCTGGGGCAGAGGGGCAGCCGCTAGGAGAGACTGAAAGCAGCAGCTAGGACTGAGGAGTGGGTTTTATTGTCCTTCAGAGCTCTTCAAGCTGTCCCCTCTGTCATCACTCCCTGGATGTGTGGGGCATGGTTCCTTCCCTGGGAAGGCTAAGTTCAGTTCTGTTTTTTATTCTATGAGAACAAGTCACAGCTGCAGCTGGGCCCCATGCTCTGCCCCAAGCCCCCAACCCCGCGGTGCTCTGGCGGCTTCCTGTCCACTCTCGGGGCCCTTGGGGCCTGGCTTGCTCCAGGGTCTTGGGCTACTGGCAGCTCCTCTCCTTGGGCTCCTGGCTGCCAGGCGTTGGTGCCACTTCTTAAAGGCCTGGAACCAGGGAGGAGAGGAAATGCTATTGTTGTGGGCTTTCTCCGGGGTCTGTGCTGTGCCTGCTAGAGCAACCCCTGTACCCAGCTCCTTTTGTCCCCAGGGCCCCTCCCTCTGCCCCAAGCAGCCAGCCAGTCTTGCCTAGGCCAAATGCACAAGCTCAGAATAGATCTGATGGTGAGCTGGGAAGCTGTACTCAGAGCAGAGCAAATGAGGGAGGGGGCGCTCAGGACCCAGGCCCTCCATGGGCTAGTGTGAGTGGCAGCCATGCCTCATGCCACACCTTCTTCGCAAACTGATGGACCGGGTGGGCCTGGCCTGAGCTGGGGCCACAAATCAAAGCAAGGGCTCCAGCATCCAGCCTGTGTGTTCTGTAATGGAACTGACCCCCTCCCCTGAAAACGAAGGGGCCCCGGGGCTGGCAAGCAGGGAAAGCTCCACGGTGCGTGGCTGTGGCACAGACTTCTGGAAGGCTGGCTGAGTGGAATGCAGGGAAGAGGGCAGTACCTGGGAAAGGACCCACCCATCTTCCTGCTGCTGTAACTGCTGAGCCACTCGCAGTCGCAGGATCCGCTGCCACCACGTCTGCCAGGCCCATCTCAGGTGCCACTCCCTGAGCTTTGGGGACAGTTGGCAGAGAAGGCCTCTTGTGCTCACGCTCCCCCGCAGTCCCCAGCCCTTCTGCCTTTCTCCCCCGACACTGCTGCACCAGAGTGAAAGGGCTATGGCAAGGGGGTGTCATCTGAGGAGTATTAAGAATGCAGATTCCTGGGCCTGTCCCCCAAGGTTTTGGAGTCAGTAGGTCCAAGGGCCATACTTTTGAGAGGGGTTTGGGTTAAGTATGAGGTGAAATGGGAGATGGTCAGTGTGGAGAGGGGTGCACCCACTCACCAGGGTCCGCACCAGCTGCTCTGCCCCTTGGGCATCCACCCAGTGCTGCCATGCCACTGCCAGGCACCTGGCCTGCTGGGAACCCCGCAGCCCGTGAAGCAGTGCCTCGAGGCACCGGCGCTGCAGGTACTTCCTCCTGATGGCCAAGAGCATCGTGACCCTTCAGGGCCAGAAGGAGGGCAGAGCCATGGGCCTGGGCCTGCTTTTCCAGGATCCTGCAGGAACGAGCACTGGCCAGAGAGGGCCCAGCTGTAGCCATGGCTCAGGCAAGCCCCTCAGCCCTTGCCCCCATCCCTCGGACCCACCAAACTGCACACACAGCTCCTCTTACCGTAGCCTCCGTTTATGGGCCTTGCTTTGGGCTTTGCAGGCTCTGGGCTCAGGGCTGGAGTGCGCTCTTGGTCCCTGGTCCCTCGTCCACAGGGGCAGGCCTGGGACCCAGCTACTCTGTCCAGGCCACTGTGGCCAGAGCTGGAAGGCAGGGCAGAGGGAATGTTCCCTGCACCCTGGAAAGGGGAGTTGAGTCACAAGAGGTTAAGGTGGGTCCAGGAAGGCAGCTGCTCTTAGTGCCCGCCTAGGAGTTGAGTACAGTGAGGAGGGTGGAGGAAGGTGCTGAGCTTAGCCTTGTGCCCTGCCCCCATCTCCCCAGGCCTCCAGCCTCTCCCGGCTGCCTGCCGCCCAAAGAGAAATCACAGGGGCGGGGCAGGAATGCAAAGTGTTTTCTCAGAACAGCTGAAACATTCCGAAGAGGGAATGGATGGGGAGAATGGTCAATACACATAAGACCGTGTCCCAAGGAGCTGATTTCCAGGCCCCTGAGGACTGGAGACCGCTTCACCCCTGCACTTCAGACACCGTTTGTCCCCCGGGGCAAGGTCTCCTTACTCTGAGCCCAGGCCGTTCCCCTTGGCTTCCTCCGTCCACCCAGGCTGCACTGCAGTGATGGCGCGGGAGGCACCAGCTCTGTGGCCTGTGTCCAGCAGCTGCGGGTCTGAAGGAATAGCCAGAGAGGAGCACCTGAACCCCATGGGCTTGGACTTCCTGGGGCCCCGCTGGGATTTCTTCGCTGCTCTAGCTGGCAGGACACATCCCGGCCTCTTCCACCCATTCCCCCATGTGGCTGAAGACATTCCAACAATGGGGTGGGCCCATAATAGTTAGCCCTCAGTCAGTTCCCGGAGCACAGCCCTGGGAGGGGGCTATTTCTCTCCCCACTGAAAACATTTCAAAGCTGAGTTACTTGTCTGAGGCCTCATCCCTCGGAAGCCGTCTGACTCCAGAGTCTGAGCCCCCGGCTAGTACCCTATAGAGAGGGGGCTCTCCAAAGGGGCTGCTGGGGCATGTGTGCCTGTGGCAGAAAAGAGGAGACCCTGGAATTCAGCACCCTGGGTGCCATTCCCAGCGTTTAGTTTCTAGAGGCCTCAGTTTCTCCATCAGCTTATGGGATCCTTGTCTTTACTGACAAGAATGGAATAGAAATGTAAAAGTACTCTGAAAAGCAATTGCCCTGTAACTTATCTAGAAAGAAAAGACCCTGAGACTCCAGAATCTGCTGTTGCCATAGCCCCATATGTGTGAATTCTGCAACTAGCCAAGGCTAGTTCCTTTCAATTCCATTTAAAAAACAAAAACCAGCAGGTGTGGTGGCTCATGGCGTAATGGGCCTGCCCAATGCTTTGGGAGGCCAAGGCAGGTAGATCGCTTGAGCCCAGGAGTTTGAGACAAGCCCTGGCAACATAGTGAGATCCCATTTCTACAAAAAAAAAAAAAAAAAAATTAGCCGGGTGTGGTGGCACACGTCTGTAGTCTCAGCTACTCAGGTGGCTGAGGTGGGAGGATCGTTTGAGCCCTGGAGGTTGAGGCTGCAGTGAGCTGTGATCGCACCACTGCACTCTGGCCTGGGCGACAGAGTGAGACACTGTCTGAGAACAAAAAACGACTGAAAAAAAAAATCACCTTAGCTTTTTCTCTTAGAATCTTCTCTAAAACGTATTCTTTGTGGCATTCTGAAATAGGATTCATGATGATGCCTGTTGATCTTAGGGACACTACCTCACCTGCCAGTATCTTTGGGGCTGTGTCCTTCAAGGACATGTCCCCAGACTGCTGTGCAGTGTCATTTTTTGTGTTTGGTTTGGTGGTGGCTTCTTCCCCCTTGCTAGGCTATCAACCTCTTATCACCACTTGTTGGTGTCAGAACTAACTGCTTCTGGTCTGGAGAGGGACTGACCGATGCCTTTGGGTAGAGAGAATTATGAAAGAAATTTTGGTATTTTTCTACTTTATATTTTCTGAGGTTTCTGTAATAAGCATATTTCACTTTTCCAATAAGAAAAAAAAAAACTTGGCCTGGCGCGGTGGCTCACACCTGTAATCCCAGCACTTTGGGAAGTCGAGGTGGGAGGATCACTTGAGTTCAGGAGTTCGAGACCAGCTTGGGCAATATGGTGAAACCCCGTCTCTACTAAAAATACAAAAATTAGCCAGGCGTGGTGGCGTGCACTTGTAGTCCCAGCTACTCAGGAAGCTGAGGCGGGAGAATCACTTGAACCCGGGAGGCAGAGGTTGCAGTGAGCTGAGATCACTCCTCTGCTTCAGCCTGG", entrez_query="Human[Organism]", hitlist_size=5) 

minutemark = str((time.time() - starttime)/60)
print("WRITING RESULTS XML, ", minutemark, " SINCE EXECUTION.")
with open('results.xml', 'w') as save_file: 
    blast_results = result_handle.read() 
    save_file.write(blast_results)

print("EXECUTION TIME in MINUTES: ", str((time.time() - starttime)/60))